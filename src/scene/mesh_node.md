# Узел модели (Mesh Node)

Узел модели — это узел сцены, который представляет 3D-модель. Это один из наиболее часто используемых узлов практически в каждой игре. Модели могут быть легко созданы как программно, так и с помощью 3D-редакторов (например, Blender) и загружены в вашу сцену.

## Поверхности (Surfaces)

Поверхность — это набор треугольников, которые используют один и тот же [материал](../rendering/materials.md). Узел модели может содержать ноль или более поверхностей; каждая поверхность содержит набор вершин и индексов, которые связывают вершины с треугольниками. Узлы моделей разделены на поверхности для эффективного рендеринга современными GPU.

## Как создать

Есть два основных способа, выбор зависит от ваших потребностей. В общем случае использование 3D-редакторов — это предпочтительный путь, особенно с учётом огромного количества бесплатных 3D-моделей, доступных в интернете.

> ⚠️ Движок поддерживает _только_ форматы файлов FBX и GLTF для 3D-моделей! 
> Чтобы использовать GLTF, укажите функцию `gltf` движка в вашем корневом Cargo.toml.

### Использование 3D-редакторов

Чтобы создать 3D-модель, вы можете использовать [Blender](https://www.blender.org/), а затем экспортировать её в формат `FBX`. Чтобы загрузить вашу 3D-модель в игру, вам нужно выполнить несколько простых шагов (загрузка 3D-модели не отличается от инстанцирования префаба):

```rust,no_run
{{#include ../code/snippets/src/scene/mesh.rs:load_model_to_scene}}
```

Этот фрагмент кода намеренно опускает правильное использование `async/await` (вместо этого он просто блокирует текущий поток до завершения загрузки модели) и обработку ошибок. В реальной игре вам следует тщательно обрабатывать все ошибки и правильно использовать `async/await`.

### Создание процедурной модели

Экземпляр модели может быть создан из кода, такие модели называются "процедурными". Они подходят для случаев, когда вы не можете создать модель в 3D-редакторе.

```rust,no_run
{{#include ../code/snippets/src/scene/mesh.rs:create_procedural_mesh}}
```

Как видите, создание модели процедурно требует много ручной работы и не так просто.

## Анимация

Узел модели поддерживает анимацию на основе костей (скелетная анимация) и морфинг (blend shapes). Подробнее см. в главе [Анимация](./../animation/animation.md).

## Буферы данных

Можно получить доступ к вершинному буферу и индексному буферу модели для чтения или записи данных. Например, следующий код извлекает мировые координаты каждой вершины анимированной модели:

```rust ,no_run
{{#include ../code/snippets/src/scene/mesh.rs:extract_world_space_vertices}}
```